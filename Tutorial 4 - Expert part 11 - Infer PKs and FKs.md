
# Tutorial 4 - Expert part 11 - Infer PKs and FKs

[Tutorial 4 - Expert part 11 - Infer PKs and FKs](https://community.hackolade.com/slides/slide/infer-pks-and-fks-32?fullscreen=1)

## Unedited transcript of the video

hello everyone and welcome to another hackerlade tutorial in this episode we're going to be talking to you about how you can use hiccolate to infer primary keys and foreign key relationships in data models that do not necessarily already have that information in them right this can be really useful right because not always are these types of keys and relationships constraints present right sometimes you just happen to have loaded the data model from a source that did not have these constraints or sometimes the source the big data analytics platform for example like synapse or snowflake or whatever it might be does not necessarily support such constraints right and you therefore reverse engineer your model from that Target without those constraints or in many other situations you may have had the capability to have constraints but you decided not to enforce them right because obviously enforcing PKS and FKS has performance implications right so for documentation purposes and for modeling purposes we obviously do still want to know about these relationships want to know about these PKS and FKS right so what we are offering in Hackle Aid is the availability the availability of a feature that allows you to reconstruct and identify these types of um relationships and constraints using a two-phased approach right it's important to understand that this approach is based on academic work right by Young model and Byron cortic but this is all based on model metadata for example it's not based on query logs and stuff like that so if the metadata is inconsistent then you may or may not get great results with this approach so the methodology that we're using here has two phases right the first phase or the first stage is when we identify the primary keys of your entities right why because then when we in the second phase identify the foreign keys and therefore the relationships the constraints that go with that we can actually leverage those PKS already that'll have already been identified right primary key identification helps us with foreign key identification so in each stage the model the model and the method will predict a probability that an attribute is actually part of a constraint and this probability is then passed to an Optimizer to give us a prediction right so in the first phase we'll be using a number of um uh attributes or or indicators for primary keys right so the attribute position in the table the data type right the keyword that is in the attribute name the similarity of the attribute name with the entity name right and to do this we actually use a really interesting capability of calculating the string distance which is a measure of how different two sets of strings are from one another then we also use the null ability you know is it possible do we know yes or no and the attribute width right so how many bytes are in that attribute then when we have that when we have these attributes when we have these indicators you we will go through a logistic regression to estimate the probability that an attribute is actually a primary key yes or no right and then the ones with the highest probability are going to be declared to be a primary key right possibly they might be more than one and in that case we will create a composite key in the second stage we'll be identifying the foreign key relationships right and you know here's how we do that right we have a number of indicator indicators for that as well right whether or not they are a primary key the data types the data type properties the similarity of the names again right so the the uh the distance the string distance that we can calculate um whether or not um the these foreign Keys have a uh similar width right the attribute width um minimum maximum values all of these types of indicators are used to identify the foreign keys and again logistic regression is going to estimate the probabilities and the most likely foreign key constraints are going to be returned we should mention obviously that this is a best effort function you know Success is Not Guaranteed it depends on manufacturers factors and for one data model it might work great and for another data model it might not work so well right so please understand that and and handle this with care and then with that I'm going to switch over to a short demonstration of how this capability works in the Highlight Studio so here we go here we have a data model for a synapse database right which is a Microsoft product for big data analytics and in this data model I have a long list of different entities right I have sales I have promotions I have resellers I have all of this information in this data model right but you may have already noticed you know especially if I zoom out a little bit you know there are no relationships in here right so zero relationships right so this is a characteristic that you find you know for a variety of different reasons and this is a perfect possibility for us to apply this inferencing technique right so what I'm going to do here is I'm going to switch to the infer PKS and FKS capability here it will ask me to select where to apply this to right which schema and which tables we apply this to and once I do that the first stage as we already explained is going to allow me to select the primary keys right oh guess what you know I've now found a number of primary keys and then in the second phase it's going to allow me to select a number of FK relationships right when I do that and I accept all of the choices you will already have seen that there's a long list of new relationships that have been added right let's uh just quickly reorganize this and you will see it much more clearly then right that this is now a much more richer data model with a lot more links between the different entities and this obviously would be useful for us to include in our modeling and documentation efforts great with that I'm going to wrap up this short tutorial again point you to some of our documentation so that you have the latest and greatest information at your fingertips and thank you for paying attention and wish you a wonderful rest of your day have a good one