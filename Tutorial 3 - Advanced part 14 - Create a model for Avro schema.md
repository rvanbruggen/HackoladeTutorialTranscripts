
# Tutorial 3 - Advanced part 14 - Create a model for Avro schema

[Tutorial 3 - Advanced part 14 - Create a model for Avro schema](https://community.hackolade.com/slides/slide/create-a-model-for-avro-schema-56?fullscreen=1)

## Transcript of the video

hello everyone and welcome to another episode of the Hackley tutorial in today's episode we'll be talking about how you can use the Accolade studio for visually designing your Avro schemas Avro schemas have been around for quite some time um I believe they've been started at about the time when the Hadoop ecosystem was really emerging and it was an open source project that basically provides us with a data serialization framework and data exchange services that are compatible with a wide variety of different Technologies it's often used with things like Kafka Pub sub pipelines or with data Lake storage capabilities what's important to realize is that the Avro file format is actually a row oriented object container as opposed to for example parquet files that have a column oriented file format this is important because it might Define the workload where you might be applying this type of Technology Avro is typically used in more write intensive types of operations whereas parquet is very often used in more read intensive operations the nice thing about Avro is that it's actually language independent it's quite Compact and therefore also quite efficient in its usage when you develop open Avro schema model using the Accolade toolset you will actually see that it's kind of like a language agnostic contract for how different systems can interoperate for every schema you will find that there are four types of attributes the type you know the specific data type of the Json record that you are including in the model the name of the Avro schema that you are defining the name space which is the higher level logical indicator of the overall schema and then of course all of the individual Fields the individual data elements that you are including here in the Accolade Studio as usual you will find both an entity relationship representation of this model and a hierarchical representation as you can see in these little Graphics Avro uses Json to define the schema and the data types that you are going to be using but it's a little bit different from what the Json schema typically provides even though the Avro schema is actually defined using a Json format you will see that the container file has a header that contains the schema up plus one or more storage blocks right then you can see the composition and the structure of these files in the little overview graphic here on this slide one of the most powerful capabilities of an Avro schema is that it allows for schema Evolution this is important you know if you're using uh Avro as a contract between different systems then it's important that you might have different versions of that capability in production at the same time imagine a situation where you have thousands of Publishers producers of information that are integrating with some kind of integration Hub well you will never be able to ensure 100 version compatibility between all of these different systems they will never be on the same version having said that you might be able to engineer it in such a way that all of the different versions that are being used are still compatible with one another both backward and forward compatibility is a very strong feature of the Avro technology it makes it super interesting for integration Services as I just explained very often these types of schema versions will be published in a schema registry and we'll talk more about that in a little bit but schema Registries is where people can look at these different evolving versions which of course enables the goal of maximizing compatibility because you're decoupling the life cycle of Publishers and consumers there are specific guidelines and best practices for this which we will now be covering in this tutorial in a highlight Studio you will find a visual design environment for the Avro schema that allows you to anticipate the evolution of the schema it allows for message validation optimizing the message payloads it allows you to enable compatibility and interoperability and of course in integrate with the confluent or other schema registry this of course enables and promotes the ReUse of the schema despite the limited official specification and documentation that is out there so we include support for things like Avro name space references and Confluence schema Registries schema references or Union schemas so it's a graphical Avro schema design tool which you can also use to import existing Avro schemas different schema Registries are supported Confluence schema registry Azure event hubs schema registry Pulsar schema registry and other Confluence schema registry API compatible Registries can also be added to the Accolade Studio we support both forward and reverse engineering of the Avro schema into these Registries but we can also work with simpler object storage providers for a completely different use case right we can reverse engineer the Avro files that have been stored in those object storage providers like S3 or ADLs which contain data Lake files basically and then reverse engineer the schema of those files and include them in our Accolade model we maintain all of the references also the recursive references between the elements in the Avro schema right so the outputs then are your ERD your hierarchical view I mentioned those two earlier but also the syntactically correct schema generation for both users that have limited technical knowledge or developers that want to improve their productivity and their quality of their work it's also very useful of course that thanks to our polyglots data modeling capabilities you can actually convert the other targets models like open API models or relational databases or nosql databases and you can convert them into an Avro schema super easily so the integration with the schema registry is through a restful interface right we will show that a little bit later where developers can publish their schemas you can host this yourself or use one of the cloud capabilities and it's you know it's a native capability where you can forward or reverse engineer the schema in the registry it allows for of these references schema references and Union schemas with that let's take a look at the short little demo and then we can take it from there all right let's give you guys a little bit of a tour here please do review our website and the documentation there's going to be some really great information there for sure but also I would like to highlight that we'll be looking at a specific demo environment here that we've set up for the confluent cloud and it's just a online free version of the schema registry there's a couple of schemas in here but we'll be adding some more to it using our hack Elite toolset so what we'll do now is we'll create a new Arrow schema and in this schema we're going to first create a namespace right so this is customer and now within the namespace I'll add a record customer address and when the within the record I'm going to add a nested structure which is the address and the nested structure is going to look like this I'll add a field here which is a string which has the street it has the house number it has the zip code it has the city and also of course the country these are the elements that we'll be adding into our Avro schema and obviously when I save this right I'll save it into a particular directory over here overwrite what I already have when I save this obviously you will see that I also have all of the hierarchical capabilities right so I see what the structure is like in a hierarchical view but I can also say well you know I'd actually like to forward engineer this into either a file format or an entry into the schema registry over here right so this is the registry right now I've got a four schemas in there I'd like to add one here right so the average schema is valid as you can tell here and I can say okay let's apply this to my Cafe schema registry I have the connectivity set up let's connect to it and boom now the script actually added the schema to the registry over here right so if I refresh it you should see the customer address over here so what I'll do next is I'll actually try to evolve this schema using our Hackley Studio and I'll for example add another field here right which is a test field um save this again and do the same thing I would like to forward engineer this to our overall schema registry and I'll already warn you we are going to get an error here right so it's going to say that the schema is being registered because it's incompatible with the schema for the same topic and the compatibility requirements okay let's go and check this one out then and over here you will now see that there is a specific compatibility mode that has been set up which is Backward Compatible so when you change something to the registry and you forward engineer the Avro schema based on our model into the schema registry then of course it's going to check for some compatibility it has to be Backward Compatible in this case which obviously is not the case because I have created this particular additional field here which is a required field so what I'll do now is I'll add one of two things I can either go into my schema registry and loosen the compatibility settings and set them to none of course but you know the smartest thing to do is to actually look at some of um hackley's Advanced features which is that foreign schema you know this is the average schema page we can actually create something called a union type which is a really great capability that allows you to deal with these incompatibilities in a structured way and allow for both cases to happen so let's see what we'll do here is we'll go into hackerlade and say well this test field that we have over here is actually not going to be a string but it's actually going to be a null value that is not required and then we'll actually have the possibility for it to be empty or to be a string so let me show you how to do that right so we have two values that are possible here now null or a string right so these both of these are now possible I'll just save this you see here in the test field it's a multi now and I'll go and forward engineer that to my row schema registry right and you will see that now the compatibility requirements are met and the new model has been applied successfully so let's see here right so now I have two versions of the model I can actually go and look at that compare the versions these are the this is the new version right with the default null where two possibilities are available right uh null or string right so that's great I just wanted to uh illustrate how you can use accolades capabilities to the maximum including some of the advanced Avro data types obviously some of these model comparisons that we showed in the control schema registry environment you can also do those comparisons in Accolade but it's always good to have multiple options that concludes our little demo and so therefore I am going to return to this particular slide to recommend that you read up on some of this material look at the hackerelate studio online documentation the blog but also the books that we've created recently there's more coming and of course you are very welcome to follow us on the socials and try the tool for free you can just download hacklight studio and get started for free great that wraps up this part of the tutorial I hope this was useful and I wish you a wonderful rest of your day